import{B as h}from"./Button-BCI6j4vu.js";import{q as v,r as C,a8 as x,Q as A,_ as B,R as o,o as n,m as s,l as a,T as u,k as l,S as N,h as I}from"./app-CbOD6f9r.js";import{N as P}from"./Input-BefGBTxS.js";import{N as T}from"./Alert-ZmTor68y.js";const D=v({__name:"Callback",setup(w,{expose:r}){r();const i=new URL(window.location.href),e=i.searchParams.get("code"),y=i.searchParams.get("state"),g=i.searchParams.get("error"),f=i.searchParams.get("error_description"),[d,_,p]=atob(y).split("::"),c=C(),k=async()=>{const t=new URLSearchParams;t.append("client_id",d),t.append("client_secret",_),t.append("code",e),t.append("grant_type","authorization_code"),t.append("redirect_uri",p),fetch("https://www.googleapis.com/oauth2/v4/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t}).then(m=>m.json()).then(m=>{console.log(m),c.value=m})};e&&!g&&k();function S(){var t;window.open(`/tool/google/album?access_token=${(t=c.value)==null?void 0:t.access_token}`,"_blank")}const b={url:i,code:e,client:y,error:g,error_description:f,client_id:d,client_secret:_,redirect_uri:p,token:c,getToken:k,getAlbumID:S,get NAlert(){return T},get NSpace(){return A},get NSpin(){return x},get NInput(){return P},get NButton(){return h}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}});function V(w,r,i,e,y,g){return!e.code||e.error?(n(),o(e.NAlert,{key:0,title:e.error||"Error",type:"error"},{default:s(()=>[a(u(e.error_description),1)]),_:1},8,["title"])):(n(),o(e.NSpace,{key:1,vertical:"",size:"large"},{default:s(()=>{var f,d,_;return[l("p",null,[r[0]||(r[0]=l("b",null,"client_id: ",-1)),a(u(e.client_id),1)]),l("p",null,[r[1]||(r[1]=l("b",null,"client_secret: ",-1)),a(u(e.client_secret),1)]),l("p",null,[r[2]||(r[2]=l("b",null,"redirect_uri: ",-1)),a(u(e.redirect_uri),1)]),(f=e.token)!=null&&f.error||(d=e.token)!=null&&d.error_description?(n(),o(e.NAlert,{key:0,title:(_=e.token)==null?void 0:_.error,type:"error"},{default:s(()=>[a(u(e.token.error_description),1)]),_:1},8,["title"])):N("",!0),I(e.NSpace,{vertical:""},{default:s(()=>{var p,c,k;return[r[5]||(r[5]=l("b",null,"refresh_token:",-1)),e.token?N("",!0):(n(),o(e.NSpin,{key:0})),(p=e.token)!=null&&p.refresh_token?(n(),o(e.NInput,{key:1,type:"textarea",autosize:"",readonly:"",value:e.token.refresh_token},null,8,["value"])):(c=e.token)!=null&&c.access_token?(n(),o(e.NAlert,{key:2,title:"Web client",type:"warning"},{default:s(()=>r[3]||(r[3]=[a(" The refresh_token is only returned once if you use a web client. ")])),_:1})):N("",!0),(k=e.token)!=null&&k.access_token?(n(),o(e.NButton,{key:3,onClick:e.getAlbumID,block:"",type:"primary"},{default:s(()=>r[4]||(r[4]=[a("Get Album ID")])),_:1})):N("",!0)]}),_:1})]}),_:1}))}const O=B(D,[["render",V],["__scopeId","data-v-18105aea"],["__file","Callback.vue"]]);export{O as C};
