import{a as u}from"./index-CmmzNXUp.js";import{q as g,r as S,a8 as h,Q as b,_ as v,R as n,o as c,m as i,l as k,T as N,S as w,h as C,k as x}from"./app-CbOD6f9r.js";import{N as P}from"./Input-BefGBTxS.js";import{N as T}from"./Alert-ZmTor68y.js";const j=g({__name:"Callback",setup(m,{expose:s}){s();const r=new URL(window.location.href),e=r.searchParams.get("code"),l=r.searchParams.get("error"),_=r.searchParams.get("error_description"),t=r.searchParams.get("state")||"Ojo=",[o,a]=window.atob(t).split("::"),d=S(),p=async()=>{const y=await(await fetch(u()+"/alist/ali_open/code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e,grant_type:"authorization_code",client_id:o,client_secret:a})})).json();d.value=y};e&&!l&&p();const f={url:r,code:e,error:l,error_description:_,state:t,client_id:o,client_secret:a,token:d,getToken:p,get NAlert(){return T},get NSpace(){return b},get NSpin(){return h},get NInput(){return P}};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}});function A(m,s,r,e,l,_){return!e.code||e.error?(c(),n(e.NAlert,{key:0,title:e.error||"Error",type:"error"},{default:i(()=>[k(N(e.error_description),1)]),_:1},8,["title"])):(c(),n(e.NSpace,{key:1,vertical:"",size:"large"},{default:i(()=>{var t,o,a;return[(t=e.token)!=null&&t.error||(o=e.token)!=null&&o.error?(c(),n(e.NAlert,{key:0,title:(a=e.token)==null?void 0:a.error,type:"error"},{default:i(()=>[k(N(e.token.error),1)]),_:1},8,["title"])):w("",!0),C(e.NSpace,{vertical:""},{default:i(()=>[s[0]||(s[0]=x("b",null,"refresh_token:",-1)),e.token?(c(),n(e.NInput,{key:1,type:"textarea",autosize:"",readonly:"",value:e.token.refresh_token},null,8,["value"])):(c(),n(e.NSpin,{key:0}))]),_:1})]}),_:1}))}const R=v(j,[["render",A],["__scopeId","data-v-5c4a4ac9"],["__file","Callback.vue"]]);export{R as C};
